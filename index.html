<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Rick and Morty Web</title>
  <link rel="stylesheet" href="style.css" />
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-database-compat.js"></script>
</head>
<body>
  <!-- Navegación principal -->
  <nav id="main-nav">
    <ul>
      <li><a class="nav-link" href="#home">Informativo</a></li>
      <li><a class="nav-link" href="#characters">Personajes</a></li>
      <li><a class="nav-link" href="#episodes">Episodios</a></li>
      <li><a class="nav-link" href="#locations">Ubicaciones</a></li>
      <li><a class="nav-link" href="#favorites">Favoritos</a></li>
      <li><a class="nav-link" href="#register">Registro</a></li>
    </ul>
  </nav>

  <!-- Filtro de búsqueda de personajes -->
  <section id="search-filter">
    <input type="text" id="search-input" placeholder="Buscar personaje..." />
    <select id="status-filter">
      <option value="">Todos</option>
      <option value="alive">Vivo</option>
      <option value="dead">Muerto</option>
      <option value="unknown">Desconocido</option>
    </select>
  </section>

  <!-- Contenido principal -->
  <main id="content">
    <section id="home">

<!--Título con el nombre de la API utilizada.-->

<h2>Bienvenido al multiverso de Rick and Morty</h2>

<!--Imagen PNG relacionada con la temática de la API.-->

<img src="imagenes/rick-and-morty.gif" alt="Bienvenido" />

<!--Cuadro con una breve descripción de la API.-->

<p>Prepárate para adentrarte en un universo lleno de ciencia loca, viajes interdimensionales y humor ácido. 
  Acompaña al genio desquiciado Rick Sanchez y a su nieto Morty en sus caóticas aventuras a través del espacio-tiempo.
  Explora personajes, episodios y ubicaciones del universo interdimensional y descubre todos los secretos que este alocado mundo tiene para ofrecer.</p>

<!--Texto con el usuario de GitHub del estudiante.-->

<a href="https://github.com/Johnyate2509">Ingresa a mi perfil de GitHub</a>

<!--Versión de la app: V.1.0.0 (igual para todos).-->
<p>RickandMorty 1.1</p>
<!--Nombre del estudiante en la parte inferior.-->
<h2>John Anderson Yate Agredo</h2>

    </section>

    <section id="characters">
      <h2>Personajes</h2>
      <!-- Contenido dinámico desde JS -->
<script>
  export let characters = [];
export let favorites = JSON.parse(localStorage.getItem("favorites")) || [];

const characterContainer = document.getElementById("characters");
const favoritesContainer = document.getElementById("favorites");

export async function fetchCharacters() {
  let url = "https://rickandmortyapi.com/api/character";
  let allCharacters = [];

  try {
    while (url) {
      const res = await fetch(url);
      const data = await res.json();
      allCharacters = allCharacters.concat(data.results);
      url = data.info.next;
    }

    characters = allCharacters;
    renderCharacters(characters);
    renderFavorites();
  } catch (error) {
    console.error("Error fetching characters:", error);
  }
}

function createCharacterCard(char, isFavorite) {
  const card = document.createElement("div");
  card.className = "card";
  card.innerHTML = `
    <img src="${char.image}" alt="${char.name}" />
    <h3>${char.name}</h3>
    <p>${char.status}</p>
    <button class="favorite-btn" data-id="${char.id}">
      ${isFavorite ? "Eliminar de favoritos" : "Agregar a favoritos"}
    </button>
  `;
  return card;
}

export function renderCharacters(data) {
  characterContainer.innerHTML = "";

  const grid = document.createElement("div");
  grid.className = "character-grid";

  data.forEach(char => {
    const isFavorite = favorites.includes(char.id);
    const card = createCharacterCard(char, isFavorite);
    grid.appendChild(card);
  });

  characterContainer.appendChild(grid);

  document.querySelectorAll(".favorite-btn").forEach(button => {
    button.addEventListener("click", toggleFavorite);
  });
}

function toggleFavorite(e) {
  const id = parseInt(e.target.dataset.id);
  if (favorites.includes(id)) {
    favorites = favorites.filter(fav => fav !== id);
  } else {
    favorites.push(id);
  }
  localStorage.setItem("favorites", JSON.stringify(favorites));
  renderCharacters(characters);
  renderFavorites();
}

export function renderFavorites() {
  favoritesContainer.innerHTML = "<h2>Favoritos</h2>";
  const favChars = characters.filter(c => favorites.includes(c.id));

  if (favChars.length === 0) {
    favoritesContainer.innerHTML += "<p>No hay favoritos aún.</p>";
    return;
  }

  const grid = document.createElement("div");
  grid.className = "character-grid";

  favChars.forEach(char => {
    const card = createCharacterCard(char, true);
    const btn = card.querySelector(".favorite-btn");
    btn.className = "remove-favorite-btn";
    btn.textContent = "Eliminar de favoritos";
    grid.appendChild(card);
  });

  favoritesContainer.appendChild(grid);

  document.querySelectorAll(".remove-favorite-btn").forEach(button => {
    button.addEventListener("click", (e) => {
      const id = parseInt(e.target.dataset.id);
      favorites = favorites.filter(fav => fav !== id);
      localStorage.setItem("favorites", JSON.stringify(favorites));
      renderCharacters(characters);
      renderFavorites();
    });
  });
}

</script>

    </section>

    <section id="episodes">
      <h2>Lista de Episodios</h2>
      <div id="episodes-container" class="episode-list">
        <!-- Episodios se insertarán dinámicamente aquí -->
      </div>
    </section>

    <section id="locations">
      <h2>Lista de Ubicaciones</h2>
      <div id="locations-container" class="location-list">
        <!-- Ubicaciones se insertarán dinámicamente aquí -->
      </div>
    </section>

    <section id="favorites">
      <!-- Contenido dinámico desde JS -->
    </section>

    <section id="register">
      <form id="register-form">
        <input type="text" name="nombre" placeholder="Nombre" required />
        <input type="text" name="apellido" placeholder="Apellido" required />
        <input type="email" name="email" placeholder="Correo electrónico" required />
        <input type="password" name="password" placeholder="Contraseña" required />
        <input type="text" name="usuario" placeholder="Nombre de usuario" required />
        <input type="date" name="fecha_nacimiento" required />
        <select name="universo" required>
          <option value="">Elige un universo</option>
          <option value="C-137">C-137</option>
          <option value="C-500A">C-500A</option>
        </select>
        <button type="submit">Registrarse</button>
      </form>
    </section>
  </main>

  <!-- Menú inferior de navegación móvil -->
  <footer id="bottom-menu">
    <button>Inicio</button>
    <button>Buscar</button>
    <button>Favoritos</button>
    <button>Perfil</button>
  </footer>

  <!-- Script principal -->
  <script src="menu.js" type="module"></script> 
  <script src="busqueda.js" type="module"></script> 
  <script src="conexiones.js" type="module"></script> 
  <script src="episodios.js" type="module"></script> 
  <script src="lugares.js" type="module"></script> 
  <script src="perrsonajes.js" type="module"></script> 
</body>
</html>
